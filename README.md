#   Лабораторная работы №4 по дисциплине "Системы копьютерного зрения"
# Фильтрация изображений
##  Задания
&ensp; Применить методы обработки изображений:
1. Выполнить свертку изображения
2. Применить морфологические операции: эрозию и дилатацию
3. Применить 2 фильтра: фильтр Гаусса и медианный фильтр
4. Применить бинаризацию и корректировку освещенности к изображению

### Дополнительная информация

&ensp; В качестве среды выполнения был выбран сервис *google Colab*. Для обработки было взят цветное изображение размерностью 1024x512 (длина; высота) - **IMAGE.jpg** . В файлах данного репрезитория можно найти файл в формате *ipynb*, содержащий в себе весь проект - **LB_CV_LB1.ipynb**. В папке Images хранятся изображения, используемые в данной работе для демонстрации результатов работы.
  
# Общий алгоритм работы

## Загрузка библиотек и данных. Функции отображения изображений

&ensp; В начале работы были подключены необходимые библиотеки для обработки изображений: *NumPy, OpenCV, и Matplotlib*. Для загрузки изображения с *Google Drive* использована библиотека *google.colab*, а затем изображение было прочитано с использованием функции **cv2.imread**. После чтения изображения оно было преобразовано из формата *BGR* в *RGB* с помощью функции **cv2.cvtColor**. Полученные размеры изображения (высота, ширина и количество каналов) были выведены в консоль для подтверждения правильности загрузки.

## Функции для отображения изображений

&ensp; Для визуализации результатов были реализованы несколько функций. Функция **show_image** отображает одно изображение, а функция **show_images_pair** позволяет показывать пару изображений (оригинальное и обработанное) для удобного сравнения. Кроме того, была реализована функция show_channels, которая выводит каждый канал *(красный, зеленый, синий)* изображения отдельно. 

&ensp; Далее формат показа изображений будет строиться на том что сначала показывается оригнальное и обработанное изображение, а после показан каждый канал в отдельности.

## Построение гистограммы распределения пикселей по каналам

&ensp; Для анализа распределения пикселей по каналам была написана функция **plot_histogram**, которая строит гистограмму для каждого из трех каналов *RGB*. На изображениях видно, как распределяются значения пикселей в каждом канале, что помогает лучше понять отличия в цветовых характеристиках взятых изображений.

## Увеличение размеров изображения

&ensp; Для подготовки изображения к морфологическим операциям было использовано дополнение *(padding)* изображения с помощью функции написанной функции **apply_padding**. Паддинг был выполнен с использованием краевого режима *(mode='edge')*, что позволило сохранить информацию на краях изображения. После этого размеры изображения были выведены, и результаты паддинга были отображены с помощью функции **show_images_pair** для сравнения оригинального и дополненного изображений.

![alt text](Images/Padded_1.png)

![alt text](Images/orig_image_channels.png)

![alt text](Images/padded_channels.png)

## Морфологические операции

&ensp; Морфологические операции представляют собой методы обработки изображений, основанные на анализе их структуры. Они широко применяются в задачах обработки бинарных и градационных изображений, особенно при работе с контурными и текстурными элементами. Основной принцип морфологических операций заключается в изменении формы объектов на изображении с использованием специального структурного элемента.

&ensp; Для обработки изображения были применены морфологические операции эрозии и дилатации. 

### Эрозия

&ensp; **Эрозия** *(снижение яркости пикселей)* – это операция, при которой уменьшается размер объектов в изображении за счет удаления пикселей по краям. Основной принцип заключается в том, что каждый пиксель заменяется минимальным значением в окрестности, определенной ядром. В результате объекты на изображении становятся тоньше, а мелкие детали могут исчезнуть. Эрозия полезна при удалении шумов, разделении соединенных объектов и выделении тонких структур.

&ensp; *Эрозия* была реализована с помощью функции **erosion**, которая для каждого пикселя выбирает минимальное значение в окне, определяемом ядром. Результат эрозии был отображен и сопоставлен с оригинальным изображением.

![alt text](Images/Eroded_2.png)

![alt text](Images/orig_image_channels.png)

![alt text](Images/eroded_channels.png)

### Дилатация 

&ensp; **Дилатация** *(увеличение яркости пикселей)* – противоположная операция эрозии. В ходе дилатации пиксели изображения заменяются максимальным значением в заданной окрестности. Это приводит к увеличению размеров объектов, заполнению мелких пробелов и соединению разорванных контуров. Дилатация часто используется для восстановления утраченных деталей после эрозии или устранения дефектов в бинарных изображениях.

&ensp; *Дилатация* была реализована с использованием функции **dilation**. Результаты обеих операций были продемонстрированы с помощью функции

![alt text](Images/Dilated_3.png)

![alt text](Images/orig_image_channels.png)

![alt text](Images/dilated_channels.png)

## Фильтры

&ensp; Фильтры применяются для изменения свойств изображения, таких как резкость, контрастность и уровень шума. Различные типы фильтров могут улучшать качество изображения, удалять помехи или подчеркивать границы объектов.

### Фильтр Гаусса

&ensp; **Фильтр Гаусса** применяется для размытия изображения и удаления высокочастотного шума. Он основан на свертке изображения с двумерным гауссовым распределением, что приводит к равномерному сглаживанию деталей. В отличие от простого усредняющего фильтра, гауссовый фильтр сохраняет структуру изображения, постепенно уменьшая резкость контуров. Этот метод используется для предварительной обработки изображений перед сегментацией и распознаванием объектов.

&ensp; *Гауссов фильтр* был применен с помощью функции **gaussian_filter**, которая использует ядро, построенное по Гауссовому распределению. Изображение после применения фильтра было показано рядом с оригинальным. 

![alt text](Images/Gaussian_4.png)

![alt text](Images/orig_image_channels.png)

![alt text](Images/gaussian_channels.png)

### Медианный фильтр

&ensp; **Медианный фильтр** – это метод шумоподавления, который заменяет значение пикселя на медианное значение в его окрестности. Этот фильтр особенно эффективен при удалении импульсного шума (так называемого "соль и перец"), так как он не размывает изображение так сильно, как линейные фильтры. Медианный фильтр сохраняет четкость контуров и структуры объектов, что делает его полезным для обработки изображений с резкими границами.

![alt text](Images/Median_5.png)

![alt text](Images/orig_image_channels.png)

![alt text](Images/median_channels.png)

*Медианный фильтр* был реализован с помощью функции median_filter. он позволяет удалить шумы, заменяя каждый пиксель медианным значением в окне. Результаты обеих фильтраций были продемонстрированы для анализа.

## Бинаризация изображения

&ensp; **Бинаризация** – это процесс преобразования изображения в черно-белый формат путем пороговой обработки. В каждом пикселе сравнивается значение яркости с заданным порогом: если оно выше порога, пиксель становится белым, если ниже – черным. Этот метод часто используется в обработке изображений для выделения объектов и упрощения последующего анализа. Бинаризация помогает в задачах распознавания текста, обработки медицинских снимков и подготовки изображений для машинного зрения.

&ensp; Для преобразования изображения в бинарный формат была реализована функция **binarize_image**, которая для каждого пикселя проверяет его значение и преобразует в 0 или 255 в зависимости от порога. Бинаризованное изображение было отображено рядом с оригиналом для удобного анализа.

![alt text](Images/Binarized_6.png)

![alt text](Images/orig_image_channels.png)

![alt text](Images/binarized_channels.png)

## Работа с гаммой и оттенками цветов

&ensp; Цветовая коррекция является важным этапом обработки изображений, позволяющим улучшить визуальное восприятие и адаптировать изображение под определенные условия освещения.

### Корректировка цвета по коэффициенту

&ensp; *Корректировка цвета по коэффициенту* заключается в умножении значений пикселей на определенный коэффициент, который изменяет их яркость. При увеличении коэффициента изображение становится светлее, а при уменьшении – темнее. Данный метод прост в реализации и позволяет быстро корректировать общий уровень освещения на изображении.

&ensp; Для улучшения яркости изображения была применена коррекция яркости с помощью функции **adjust_brightness**, которая увеличивает яркость всех пикселей на заданный коэффициент. Результат был сравнен с оригинальным изображением. 

![alt text](Images/Brightened_7.png)

![alt text](Images/orig_image_channels.png)

![alt text](Images/brightened_channels.png)

### Корректировка цвета по гистограмме

&ensp; *Коррекция цвета по гистограмме* основана на анализе распределения интенсивностей пикселей в каждом цветовом канале и их последующем перераспределении. Этот метод позволяет добиться равномерного распределения яркостей, улучшая контраст изображения. Один из распространенных подходов – выравнивание гистограммы, при котором темные области становятся светлее, а светлые – более контрастными. Это полезно при обработке изображений с неравномерным освещением или слабовыраженными деталями.

&ensp; *Коррекция яркости с помощью выравнивания гистограммы* была выполнена через функцию equalize_histogram. Данная коррекция более равномерно выравнила недостающую освещенностью в темных областях. Результаты выравнивания были продемонстрированы, и были построены гистограммы для оригинального и обработанного изображений.

![alt text](Images/Equalized_8.png)

![alt text](Images/orig_image_channels.png)

![alt text](Images/equalized_channels.png)

&ensp; Гистогрыммы:

![alt text](Images/orig_image_channels_hist.png)

![alt text](Images/equal_channels_hist.png)

### Улучшенная корректировка цвета по гистограмме

&ensp; Для более качественного выравнивания гистограммы был применен улучшенный метод через функцию **enhanced_equalize_histogram**, которая включает добавление шума в канал изображения. Данное улучшение сделало более планые переход и распределение пикселей. Результаты улучшенного выравнивания были продемонстрированы на изображении и сопоставлены с результатами обычного выравнивания.

![alt text](Images/Enhance_Equalized_9.png)

![alt text](Images/orig_image_channels.png)

![alt text](Images/enhance_equalized_channels.png)

&ensp; Данное улучшение практически никак не отобразилось на общем представлении изображения:

![alt text](Images/Equalized_different_10.png)

&ensp; Однако само распределение пикселей на гистограммах видно отчетливо:

![alt text](Images/equal_channels_hist.png)

![alt text](Images/enh_equal_channels_hist.png)

##  Результаты работы

&ensp; В ходе выполнения работы были реализованы основные методы обработки изображений с использованием библиотеки *NumPy*. Были изучены и применены морфологические операции *(эрозия и дилатация)*, фильтрация изображений *(Гауссов и медианный фильтры)*, бинаризация, а также методы коррекции яркости, включая выравнивание гистограммы. Проведенный анализ гистограмм позволил оценить распределение интенсивностей пикселей, а применение паддинга обеспечило корректную обработку краевых областей изображения. 

&ensp; В результате были созданы материалы, показывающие этапы работы фильтров, а так же позволяюще сравнить начальное и обработанное изображение после применения каждого из фильтров. Вся работа была оформлена в проекте на платформе *GitHub*, а код был реализован на платформе  [*google Colab*](https://colab.research.google.com/drive/1r_C3f1s0ku-w7nF-LiMl9refau3HuNxp#scrollTo=ifw78g0wMGY2) .
